# SpecFeature

SpecFeature — это последовательный процесс подготовки и сопровождения фичи: от формулирования бизнес-контекста до проверки выполненных задач. Он помогает синхронизировать продуктовую, инженерную и QA-команды, уменьшить количество изменений «на лету» и зафиксировать критерии успешности до начала разработки. Все артефакты генерируются LLM на основе единого входного контекста.

## Структура каталога `/spec`

### Начальная структура (создаётся при инициализации)
```
/spec
├── README.md             ← это руководство
├── feature.md            ← основной шаблон, который запускает spec-feature
└── core                  ← базовые шаблоны для частных этапов
    ├── spec.md           ← структура спецификации
    ├── plan.md           ← структура технического плана
    ├── tasks.md          ← структура списка задач
    ├── verify.md         ← структура отчёта проверки
    └── hotfix.md         ← структура хотфикса и актуализации артефактов
```

### Полная структура (после создания первой фичи)
```
/spec
├── README.md             ← это руководство
├── feature.md            ← основной шаблон, который запускает spec-feature
├── core                  ← базовые шаблоны для частных этапов
│   ├── spec.md           ← структура спецификации
│   ├── plan.md           ← структура технического плана
│   ├── tasks.md          ← структура списка задач
│   ├── verify.md         ← структура отчёта проверки
│   └── hotfix.md         ← структура хотфикса и актуализации артефактов
└── features              ← каталог с материалами фич (создаётся автоматически)
    ├── <feature>         ← папка конкретной фичи (например, `user-auth`)
    │   ├── spec.md       ← актуальная спецификация
    │   ├── plan.md       ← технический план
    │   ├── tasks.md      ← чек-лист реализации
    │   └── verify-report.md (опционально) — журнал проверок
    └── ...               ← другие фичи, созданные по шаблонам
```

> **Примечание:** Папка `features` создаётся автоматически при создании первой фичи через `spec/feature.md`.

## С чего начать

Для запуска создания спецификации, нужно использовать `spec/feature.md`. Он создаст спецификацию, план и список задач за один запрос.

**Пример использования:**
```
Используй шаблон из spec/feature.md.
@user-auth@ Нужно добавить аутентификацию пользователей через email и пароль. Пользователь должен иметь возможность зарегистрироваться, войти в систему и восстановить пароль. Интеграция с существующей системой уведомлений обязательна.
```

Это создаст папку `spec/features/user-auth/` с тремя файлами: `spec.md`, `plan.md` и `tasks.md`.

## Формат входных параметров

Передавай параметры одной строкой в формате `@<feature>@ <контекст>`:

- значение между первыми двумя символами `@` используется как **FEATURE** и определяет папку фичи (`@payments@` → `spec/features/payments`);
- всё, что следует после второго `@`, — это **CONTEXT**. Оно может занимать несколько строк, включать списки, ссылки и дополнительные пояснения.

## Как запустить создание спецификаций

Используй любой AI Ассистент, который умеет создавать папки и файлы, например: `Claude Code`, `Gemini CLI`, `Codex CLI`, `Copilot`, `Cursor` и тд.

1. **Передай ему промпт в таком формате**
   ```
   Используй шаблон из spec/feature.md.
   @<feature>@ <контекст>
   ```
2. **Что происходит дальше**
   AI ассистент генерирует три Markdown-документа подряд:
   - `spec/features/{FEATURE}/spec.md` — спецификация, описывающая ценность и пользовательские сценарии.
   - `spec/features/{FEATURE}/plan.md` — технический план, опирающийся на спецификацию и контекст.
   - `spec/features/{FEATURE}/tasks.md` — чек-лист задач на реализацию и тестирование.

## Как запустить выполнение задач на основе созданных спецификаций

После создания спецификации и плана, можно приступать к реализации:

1. **Запуск выполнения задач**
   ```
   Выполни все задачи в `spec/features/{FEATURE}/tasks.md`
   ```

2. **Что происходит во время выполнения**
   - AI ассистент последовательно выполняет задачи из чек-листа
   - Каждая выполненная задача отмечается как завершённая
   - При возникновении проблем ассистент может запросить уточнения
   - Прогресс можно отслеживать по обновлению чекбоксов в `tasks.md`

3. **Пример для фичи user-auth**
   ```
   Выполни все задачи в `spec/features/user-auth/tasks.md`
   ```

## Что происходит после выполнения задач

После завершения всех задач запускается автоматическая проверка:

1. **Автоматическая проверка**
   - AI ассистент использует шаблон `spec/core/verify.md`
   - Сравнивает реализованный функционал с требованиями из `spec.md`
   - Проверяет соответствие техническому плану из `plan.md`

2. **Результаты проверки**
   - Создаётся отчёт `spec/features/{FEATURE}/verify-report.md`
   - Обновляются статусы задач в `tasks.md` (✅ выполнено / ❌ требует доработки)
   - Фиксируются найденные несоответствия и рекомендации

3. **Содержание отчёта проверки**
   - Сводка выполненных задач
   - Список найденных проблем
   - Рекомендации по исправлению
   - Оценка готовности фичи к продакшену

## Обновление существующей фичи

Для обновления существующей фичи повторно используй `spec/feature.md`, указав название папки нужной фичи и список изменений:

**Пример обновления:**
```
Используй шаблон из spec/feature.md.
@user-auth@ Добавить двухфакторную аутентификацию (2FA) через SMS. Пользователь должен иметь возможность включить/выключить 2FA в настройках профиля. Интеграция с существующим SMS-провайдером.
```

AI ассистент корректно перезапишет `spec.md`, `plan.md` и `tasks.md`, сохранив структуру и актуализировав содержание под новые требования.

## Troubleshooting

### Частые проблемы и решения

**Проблема:** AI ассистент не создаёт папку фичи
- **Решение:** Убедись, что используешь правильный формат `@feature@ context` и что ассистент имеет права на создание файлов

**Проблема:** Задачи выполняются не в том порядке
- **Решение:** Проверь нумерацию задач в `tasks.md` и при необходимости переупорядочь их

**Проблема:** Проверка не запускается автоматически
- **Решение:** Убедись, что все задачи в `tasks.md` отмечены как выполненные, затем вручную запусти проверку:
  ```
  Используй шаблон из spec/core/verify.md для проверки spec/features/{FEATURE}/
  ```

**Проблема:** Конфликт при обновлении существующей фичи
- **Решение:** Создай резервную копию текущих файлов перед обновлением или используй git для отслеживания изменений